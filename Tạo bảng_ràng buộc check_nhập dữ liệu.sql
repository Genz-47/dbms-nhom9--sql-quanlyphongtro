--Lưu Quang Trung - 15110345
--Trần Quốc Cường - 15110175

--Lưu Quang Trung - 15110345
--Trần Quốc Cường - 15110175

Create Database QuanLyPhongTro
go
use QuanLyPhongTro
go


 
 Create table QUYEN(
	MaQ nchar(10) primary key,
	TENQUYEN nvarchar(20)
)

Create table DICHVU(
MADV nchar(10),
TENDV nvarchar(20),
GIADV int,
Primary key (MADV)
);
go

Create table KHACHHANG(
MAKH nchar(10) primary key,
TENKH nvarchar(20),
NGAYSINH date,
SOCMND int unique,
DIACHI nvarchar(50),
NGHENGHIEP nvarchar(50),
SDT int
);
go

create table ACCOUNTS(
	Username  nchar (10) PRIMARY KEY ,
	Pwd nvarchar(25),
	MaQ nchar(10) references QUYEN(MaQ)
);
go

Create table PHONGTRO(
MAPHONG nchar(10) primary key,
TENPHONG varchar(20),
HIENTRANGPHONG bit,
GIAPHONG float,
SOLUONGNGUOI int
)

Create table THIETBI(
MATB nchar(10) primary key,
TENTB nvarchar(50),
GIATB float
)


Create table PHIEUDANGKY(
MAPDK nchar(10) primary key,
MAKH nchar(10)references KHACHHANG(MAKH),
NGAYTHUE date,
NGAYTRA date,
SOPHONG nchar(10) references PHONGTRO(MAPHONG),
MATB nchar(10),
TRATRUOC float,
TRASAU float,
CHUTHICH nvarchar(50)
)
go

Create table DANGKY_DV(
MADV nchar(10),
MAPDK nchar(10),
NGAYBATDAU date,
NGAYKETHUC date,
Primary key (MADV,MAPDK),
Foreign key (MADV) references DICHVU(MADV),
Foreign key (MAPDK) references PHIEUDANGKY(MAPDK)
)
go


Create table TRANGBI(
MAPHONG nchar(10),
MATB nchar(10),
NGAYTRANGBI date,
Primary key (MAPHONG,MATB),
Foreign key (MAPHONG) references PHONGTRO(MAPHONG),
Foreign key (MATB) references THIETBI(MATB)
)

Create table PHIEUTHANHTOAN(
MAPTT nchar(10) primary key,
MAPDK nchar(10),
SOTHANG int,
NGAYTT date,
TONGTIEN float,
Foreign key (MAPDK) references PHIEUDANGKY(MAPDK)
)


Create table HOADON(
MAHD nchar(10) primary key,
MAPTT nchar(10) references PHIEUTHANHTOAN(MAPTT),
NGAYLAPHD date,
THUEVAT float
)




--Add Check Contraint
ALTER TABLE KHACHHANG ADD CONSTRAINT CHK_NgaySinh CHECK (NGAYSINH<getdate());
ALTER TABLE THIETBI ADD CONSTRAINT CHK_TB CHECK (GIATB>0);
ALTER TABLE PHONGTRO ADD CONSTRAINT CHK_PT CHECK (GIAPHONG>500000);
ALTER TABLE PHIEUDANGKY ADD CONSTRAINT CHK_PHIEUDANGKY CHECK (NGAYTRA>NGAYTHUE);
ALTER TABLE PHIEUDANGKY ADD CONSTRAINT CHK_PHIEUDANGKY_TraTruoc CHECK (TRATRUOC>500000);
ALTER TABLE PHIEUTHANHTOAN ADD CONSTRAINT CHK_PHIEUTT_SoThang CHECK (SOTHANG>0);
ALTER TABLE PHIEUTHANHTOAN ADD CONSTRAINT CHK_PHIEUTT_TongTien CHECK (TONGTIEN>500000);
ALTER TABLE DICHVU ADD CONSTRAINT CHK_DV_GiaDV CHECK (GIADV>0);


--Dữ liệu QUYEN
INSERT INTO dbo.QUYEN VALUES ('QLK',N'Quản lí Khách Hàng');
INSERT INTO dbo.QUYEN VALUES ('QLDV',N'Quản lí Dịch Vụ');
INSERT INTO dbo.QUYEN  VALUES ('QLTB',N'Quản lí Thiết Bị');
INSERT INTO dbo.QUYEN  VALUES ('USERKH',N'Khách Hàng')


--Dữ liệu KhachHang

INSERT INTO dbo.KHACHHANG VALUES ('KH01',N'Nguyễn Quang Huy','1997-03-17','212383726',N'Quảng Ngãi City',N'Sinh viên','01668659489'); 
INSERT INTO dbo.KHACHHANG VALUES ('KH02',N'Ngô Văn Huy','1997-03-23','231347892',N'Quang Ngai Province ',N'Sinh viên','0915050818' ); 
INSERT INTO dbo.KHACHHANG VALUES ('KH03',N'Trần Quốc Cường','1997-03-10','452312312',N'Quy Nhon City',N'Sinh viên','0919115267' ); 
INSERT INTO dbo.KHACHHANG VALUES ('KH04',N'Lê Vi Nhật Hiếu','1997-03-27','235678432',N'Thu Duc District',N'Sinh viên','0205050811'); 
INSERT INTO dbo.KHACHHANG VALUES ('KH05',N'Hà Vũ Kim Tuyền','1997-09-19','222312312',N'District 8',N'Sinh viên','0997875231'); 
INSERT INTO dbo.KHACHHANG VALUES ('KH06',N'Nguyễn Văn Tèo','1997-02-05','287655432',N'District 1',N'Sinh viên','0905670812'); 
INSERT INTO dbo.KHACHHANG VALUES ('KH07',N'Châu Gia Kiệt','1997-01-01','231231231',N'Da Nang City',N'Sinh viên','0965050812'); 
INSERT INTO dbo.KHACHHANG VALUES ('KH08',N'Nguyễn Hà Kim Anh','1997-06-29','209987765',N'Phú Yên Province',N'Sinh viên','0919050812'); 
INSERT INTO dbo.KHACHHANG VALUES ('KH09',N'Lâm Chí Hào','1997-03-13','266633432',N'172 Tôn Đức Thắng',N'Sinh viên','0931231233'); 
INSERT INTO dbo.KHACHHANG VALUES ('KH10',N'Nguyễn Hữu Nghị','1997-04-20','298565345',N'Vung Tau City',N'Sinh viên','0911232134');
INSERT INTO dbo.KHACHHANG VALUES ('KH11',N'Đào Hoàn Vũ','1997-05-20','298565045',N'Vung Tau City',N'Sinh viên','0911232134');
INSERT INTO dbo.KHACHHANG VALUES ('KH12',N'Bùi Anh Tuấn','1997-12-29','232323232',N'Ba Ria City',N'Sinh viên','0932321231');
INSERT INTO dbo.KHACHHANG VALUES ('KH13',N'Lương Xuân Trúc','1997-11-22','209090876',N'Can Tho City',N'Sinh viên','01738231231');
INSERT INTO dbo.KHACHHANG VALUES ('KH14',N'Từ Văn Nghiêm','1997-06-13','211231232',N'Da Lat City',N'Sinh viên','01232123198');
INSERT INTO dbo.KHACHHANG VALUES ('KH15',N'Diệp Thành Đạt','1997-06-24','231236789',N'Da Lat City',N'Công nhân','0987654212');
INSERT INTO dbo.KHACHHANG VALUES ('KH16',N'Ngô Tuấn Lâm','1990-01-10','253242123',N'Ha Noi City',N'Công nhân','0987654333');
INSERT INTO dbo.KHACHHANG VALUES ('KH17',N'Lâm Diệp Phi','1990-06-24','231256789',N'Da Nang City',N'Công nhân','0987654444');
 

--Dữ liệu DichVu
INSERT INTO dbo.DICHVU VALUES (N'DV01  ', N'Wifi',100000);
INSERT INTO dbo.DICHVU VALUES (N'DV02  ', N'Wash Clothes',50000);
INSERT INTO dbo.DICHVU  VALUES (N'DV03 ', N'Clean the room',3000000);
INSERT INTO dbo.DICHVU  VALUES (N'DV04 ', N'Parking',50000)
INSERT INTO dbo.DICHVU  VALUES (N'DV05 ', N'Food Serving',600000);

--Dữ liệu PhongTro

INSERT INTO dbo.PHONGTRO VALUES (N'PT01', N'Phòng 1', 1, 3000000,2);
INSERT INTO dbo.PHONGTRO VALUES(N'PT02', N'Phòng 2', 1, 3000000,2);
INSERT INTO dbo.PHONGTRO VALUES(N'PT03 ', N'Phòng 3', 1, 3000000,2);
INSERT INTO dbo.PHONGTRO VALUES (N'PT04 ', N'Phòng 4', 1, 3000000,2);
INSERT INTO dbo.PHONGTRO VALUES (N'PT05 ', N'Phòng 5', 1, 3000000,2);
INSERT INTO dbo.PHONGTRO VALUES (N'PT06 ', N'Phòng 6', 1, 3000000,2);
INSERT INTO dbo.PHONGTRO VALUES (N'PT07 ', N'Phòng 7', 1, 3000000,2);
INSERT INTO dbo.PHONGTRO VALUES (N'PT08 ', N'Phòng 8', 1, 3000000,1);
INSERT INTO dbo.PHONGTRO VALUES (N'PT09 ', N'Phòng 9', 1, 3000000,1);
INSERT INTO dbo.PHONGTRO VALUES (N'PT10 ', N'Phòng 10', 1, 3000000,1);
INSERT INTO dbo.PHONGTRO VALUES (N'PT11 ', N'Phòng 11', 0, 3000000,0);
INSERT INTO dbo.PHONGTRO VALUES (N'PT12 ', N'Phòng 12', 0, 3000000,0);
INSERT INTO dbo.PHONGTRO VALUES (N'PT13 ', N'Phòng 13', 0, 3000000,0);
INSERT INTO dbo.PHONGTRO VALUES (N'PT14 ', N'Phòng 14', 0, 3000000,0);
INSERT INTO dbo.PHONGTRO VALUES (N'PT15 ', N'Phòng 15', 0, 3000000,0);


-- Dữ liệu ThietBi


INSERT INTO dbo.THIETBI VALUES ('TB01',N'Tủ lạnh',3610000);
INSERT INTO dbo.THIETBI VALUES ('TB02',N'Máy giặt',4610000);
INSERT INTO dbo.THIETBI VALUES ('TB03',N'Máy quạt',2610000);
INSERT INTO dbo.THIETBI VALUES ('TB04',N'Đèn',1610000);


--Du liệu TrangBi

INSERT INTO dbo.TRANGBI VALUES ('PT01','TB01','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT01','TB02','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT02','TB01','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT02','TB03','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT03','TB04','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT03','TB01','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT05','TB02','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT05','TB03','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT06','TB01','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT06','TB02','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT07','TB02','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT07','TB03','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT08','TB03','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT08','TB04','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT09','TB04','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT09','TB01','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT10','TB02','2016-07-10');
INSERT INTO dbo.TRANGBI VALUES ('PT10','TB03','2016-07-10');

--Dữ liệu PhieuDangKy


INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK01','KH01','2017-01-01','2018-01-01','PT01','TB01',9000000,9000000,N'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK02','KH02','2017-01-01','2018-01-01','PT01','TB02',9000000,9000000,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK03','KH03','2017-02-02','2017-05-02','PT02','TB01',2250000,2250000,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK04','KH04','2017-02-02','2017-05-02','PT02','TB03',2250000,2250000,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK05','KH05','2017-03-03','2017-06-03','PT03','TB04',2250000,2250000,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK06','KH06','2017-03-03','2017-06-03','PT03','TB01',2250000,2250000,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK07','KH07','2017-04-04','2017-09-04','PT04','',4250000,3250000,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK08','KH08','2017-04-04','2017-09-04','PT04','',4250000,3250000,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK09','KH09','2017-05-05','2017-10-05','PT05','TB02',4250000,3250000,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK10','KH10','2017-05-05','2017-10-05','PT05','TB03',4250000,3250000,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK11','KH11','2017-06-06','2017-07-06','PT06','TB01',3000000,0,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK12','KH12','2017-06-06','2017-07-06','PT06','TB02',3000000,0,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK13','KH13','2017-01-12','2017-05-12','PT07','TB02',6000000,6000000,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK14','KH14','2017-01-12','2017-05-12','PT07','TB03',6000000,6000000,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK15','KH15','2017-01-16','2017-06-16','PT08','TB04',4250000,2250000,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK16','KH16','2017-01-01','2017-05-01','PT09','TB04',6000000,6000000,'');
INSERT INTO dbo.PHIEUDANGKY VALUES ('PDK17','KH17','2017-01-01','2017-05-01','PT10','TB04',6000000,6000000,'');



--Dữ liệu DANGKY_DV

INSERT INTO dbo.DANGKY_DV VALUES ('DV01', 'PDK01','2017-01-01','2018-01-01');
INSERT INTO dbo.DANGKY_DV VALUES ('DV03', 'PDK01','2017-01-01','2018-01-01');
INSERT INTO dbo.DANGKY_DV VALUES ('DV02', 'PDK02','2017-01-01','2018-01-01');
INSERT INTO dbo.DANGKY_DV VALUES ('DV04', 'PDK02','2017-01-01','2018-01-01');
INSERT INTO dbo.DANGKY_DV VALUES ('DV01', 'PDK03','2017-02-02','2017-05-02');
INSERT INTO dbo.DANGKY_DV VALUES ('DV03', 'PDK03','2017-02-02','2017-05-02');
INSERT INTO dbo.DANGKY_DV VALUES ('DV02', 'PDK04','2017-02-02','2017-05-02');
INSERT INTO dbo.DANGKY_DV VALUES ('DV04', 'PDK04','2017-02-02','2017-05-02');
INSERT INTO dbo.DANGKY_DV VALUES ('DV01', 'PDK05','2017-03-03','2017-06-03');
INSERT INTO dbo.DANGKY_DV VALUES ('DV04', 'PDK05','2017-03-03','2017-06-03');
INSERT INTO dbo.DANGKY_DV VALUES ('DV02', 'PDK06','2017-03-03','2017-06-03');
INSERT INTO dbo.DANGKY_DV VALUES ('DV04', 'PDK06','2017-03-03','2017-06-03');
INSERT INTO dbo.DANGKY_DV VALUES ('DV01', 'PDK07','2017-04-04','2017-09-04');
INSERT INTO dbo.DANGKY_DV VALUES ('DV05', 'PDK07','2017-04-04','2017-09-04');
INSERT INTO dbo.DANGKY_DV VALUES ('DV02', 'PDK08','2017-04-04','2017-09-04');
INSERT INTO dbo.DANGKY_DV VALUES ('DV04', 'PDK08','2017-04-04','2017-09-04');
INSERT INTO dbo.DANGKY_DV VALUES ('DV01', 'PDK09','2017-05-05','2017-10-05');
INSERT INTO dbo.DANGKY_DV VALUES ('DV04', 'PDK10','2017-05-05','2017-10-05');
INSERT INTO dbo.DANGKY_DV VALUES ('DV04', 'PDK11','2017-06-06','2017-07-06');
INSERT INTO dbo.DANGKY_DV VALUES ('DV04', 'PDK12','2017-06-06','2017-07-06');
INSERT INTO dbo.DANGKY_DV VALUES ('DV04', 'PDK13','2017-01-12','2017-05-12');
INSERT INTO dbo.DANGKY_DV VALUES ('DV04', 'PDK14','2017-01-12','2017-05-12');
INSERT INTO dbo.DANGKY_DV VALUES ('DV05', 'PDK15','2017-01-16','2017-06-16');


-- Dữ liệu phiếu thanh toán.

INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT01','PDK01',12,'2017-01-01',36000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT02','PDK02',12,'2017-01-01',36000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT03','PDK03',3,'2017-02-02',9000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT04','PDK04',3,'2017-02-02',9000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT05','PDK05',3,'2017-03-03',9000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT06','PDK06',3,'2017-03-03',9000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT07','PDK07',5,'2017-04-04',15000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT08','PDK08',5,'2017-04-04',15000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT09','PDK09',5,'2017-05-05',15000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT10','PDK10',5,'2017-05-05',15000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT11','PDK11',1,'2017-06-06',3000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT12','PDK12',1,'2017-06-06',3000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT13','PDK13',4,'2017-01-12',12000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT14','PDK14',4,'2017-05-12',12000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT15','PDK15',5,'2017-06-16',15000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT16','PDK16',4,'2017-01-01',12000000);
INSERT INTO dbo.PHIEUTHANHTOAN VALUES ('PTT17','PDK17',4,'2017-01-01',12000000);

-- Dữ liệu hóa đơn.


INSERT INTO dbo.HOADON VALUES ('HD01','PTT01','2017-01-01',0.1);
INSERT INTO dbo.HOADON VALUES ('HD02','PTT02','2017-01-01',0.1);
INSERT INTO dbo.HOADON VALUES ('HD03','PTT03','2017-02-02',0.1);
INSERT INTO dbo.HOADON VALUES ('HD04','PTT04','2017-02-02',0.1);
INSERT INTO dbo.HOADON VALUES ('HD05','PTT05','2017-03-03',0.1);
INSERT INTO dbo.HOADON VALUES ('HD06','PTT06','2017-03-03',0.1);
INSERT INTO dbo.HOADON VALUES ('HD07','PTT07','2017-04-04',0.1);
INSERT INTO dbo.HOADON VALUES ('HD08','PTT08','2017-04-04',0.1);
INSERT INTO dbo.HOADON VALUES ('HD09','PTT09','2017-05-05',0.1);
INSERT INTO dbo.HOADON VALUES ('HD10','PTT10','2017-05-05',0.1);
INSERT INTO dbo.HOADON VALUES ('HD11','PTT11','2017-01-04',0.1);
INSERT INTO dbo.HOADON VALUES ('HD12','PTT12','2017-01-04',0.1);
INSERT INTO dbo.HOADON VALUES ('HD13','PTT13','2017-01-12',0.1);
INSERT INTO dbo.HOADON VALUES ('HD14','PTT14','2017-01-12',0.1);
INSERT INTO dbo.HOADON VALUES ('HD15','PTT15','2017-06-16',0.1);
INSERT INTO dbo.HOADON VALUES ('HD16','PTT16','2017-01-01',0.1);
INSERT INTO dbo.HOADON VALUES ('HD17','PTT17','2017-01-01',0.1);


--ACCOUNTS
INSERT ACCOUNTS VALUES ('KH01','123','USERKH');
INSERT ACCOUNTS VALUES ('KH02','123','USERKH');
INSERT ACCOUNTS VALUES ('KH03','123','USERKH');
INSERT ACCOUNTS VALUES ('KH04','123','USERKH');
INSERT ACCOUNTS VALUES ('KH05','123','USERKH');
INSERT ACCOUNTS VALUES ('KH06','123','USERKH');
INSERT ACCOUNTS VALUES ('KH07','123','USERKH');
INSERT ACCOUNTS VALUES ('KH08','123','USERKH');
INSERT ACCOUNTS VALUES ('KH09','123','USERKH');
INSERT ACCOUNTS VALUES ('KH10','123','USERKH');
INSERT ACCOUNTS VALUES ('KH11','123','USERKH');
INSERT ACCOUNTS VALUES ('KH12','123','USERKH');
INSERT ACCOUNTS VALUES ('KH13','123','USERKH');
INSERT ACCOUNTS VALUES ('KH14','123','USERKH');
INSERT ACCOUNTS VALUES ('KH15','123','USERKH');
INSERT ACCOUNTS VALUES ('KH16','123','USERKH');
INSERT ACCOUNTS VALUES ('KH17','123','USERKH');
INSERT ACCOUNTS VALUES ('userQLK','123','QLK');
INSERT ACCOUNTS VALUES ('userQLDV','123','QLDV');
INSERT ACCOUNTS VALUES ('userQLTB','123','QLTB');






--trigger/function



